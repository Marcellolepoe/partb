<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Singapore Part B Question Bank</title>
    <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@400;700&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* General Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Crimson Text', serif;
            background-color: #FDF6E3;
            color: #5D4E37;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .container {
            max-width: 1200px;
            margin: 20px auto;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(8px);
            border-radius: 24px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .navbar {
            background-color: #D4A574;
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 30px;
        }
        .navbar-title {
            font-family: 'Kalam', cursive;
            font-size: 1.5rem;
            font-weight: 700;
        }
        .back-button {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #D4A574;
            color: #5D4E37;
            font-size: 0.9rem;
            cursor: pointer;
            padding: 10px 16px;
            margin: 0 0 20px 0;
            border-radius: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: inline-block;
        }
        .back-button:hover {
            background: #D4A574;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .home-button {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: #5D4E37;
            font-size: 0.9rem;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 6px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .home-button:hover {
            background: rgba(255, 255, 255, 1);
            border-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .main-content {
            padding: 40px;
            flex-grow: 1;
            position: relative;
        }
        .menu-title {
            font-family: 'Kalam', cursive;
            font-size: 2rem;
            color: #5D4E37;
            margin-bottom: 30px;
            text-align: center;
        }
        .practice-areas, .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .practice-area, .subject-card {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(212, 165, 116, 0.4);
            border-radius: 20px;
            padding: 35px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .practice-area:hover, .subject-card:hover {
            border-color: #D4A574;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            background: rgba(255, 255, 255, 1);
        }
        .practice-area h4, .subject-card h4 {
            font-family: 'Kalam', cursive;
            font-size: 1.6rem;
            color: #5D4E37;
            margin-bottom: 15px;
            font-weight: 600;
        }
        .practice-area p, .subject-card p {
            color: #8B7355;
            font-size: 1.1rem;
            line-height: 1.4;
        }
        .quiz-interface {
            padding: 40px;
            flex-grow: 1;
            position: relative;
        }
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(212, 165, 116, 0.3);
        }
        .quiz-title {
            font-family: 'Kalam', cursive;
            font-size: 1.8rem;
            color: #5D4E37;
            text-align: center;
            flex-grow: 1;
        }
        .question-area {
            background-color: #FDF6E3;
            padding: 30px;
            border-radius: 16px;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.05);
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .question-text {
            font-size: 1.2rem;
            color: #5D4E37;
            margin-bottom: 20px;
            font-weight: 600;
        }
        .statements {
            margin-bottom: 20px;
        }
        .statement {
            font-size: 1.1rem;
            color: #5D4E37;
            margin-bottom: 8px;
            padding-left: 10px;
        }
        .options .option {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(212, 165, 116, 0.5);
            border-radius: 8px;
            padding: 12px 18px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            color: #5D4E37;
        }
        .options .option:hover {
            background: rgba(212, 165, 116, 0.1);
            border-color: #D4A574;
        }
        .options .option.selected {
            background-color: rgba(212, 165, 116, 0.3);
            border-color: #D4A574;
        }
        .options .option.correct {
            background-color: #E8F5E9;
            border-color: #4CAF50;
        }
        .options .option.incorrect {
            background-color: #FFEBEE;
            border-color: #F44336;
        }
        .explanation {
            margin-top: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            border-left: 3px solid #D4A574;
            backdrop-filter: blur(8px);
        }
        .explanation h4 {
            font-family: 'Kalam', cursive;
            margin-bottom: 15px;
            color: #5D4E37;
            font-weight: 400;
            font-size: 1.1rem;
        }
        .explanation p {
            margin-bottom: 10px;
            color: #5D4E37;
            line-height: 1.6;
        }
        .explanation h5 {
            color: #8B7355;
            margin: 20px 0 10px 0;
            font-weight: 600;
            font-family: 'Kalam', cursive;
            font-size: 1.1rem;
        }
        .explanation ul {
            margin: 10px 0 15px 20px;
            color: #5D4E37;
        }
        .explanation li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        .explanation strong {
            color: #5D4E37;
            font-weight: 600;
        }
        .quiz-navigation {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(212, 165, 116, 0.3);
        }
        .quiz-navigation button {
            background-color: #D4A574;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .quiz-navigation button:hover {
            background-color: #C08B5A;
            transform: translateY(-2px);
        }
        .quiz-navigation button:disabled {
            background-color: #E0E0E0;
            cursor: not-allowed;
            transform: none;
        }
        .jump-to-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        .jump-to-section label {
            color: #5D4E37;
            font-size: 1rem;
            font-weight: 500;
            white-space: nowrap;
        }
        .jump-to-section input {
            padding: 12px;
            border: 2px solid rgba(212, 165, 116, 0.5);
            border-radius: 8px;
            width: 90px;
            font-size: 1rem;
            color: #5D4E37;
            background: rgba(255, 255, 255, 0.9);
            text-align: center;
            transition: border-color 0.3s ease;
        }
        .jump-to-section input:focus {
            outline: none;
            border-color: #D4A574;
            box-shadow: 0 0 0 2px rgba(212, 165, 116, 0.2);
        }
        .jump-to-section button {
            background-color: #D4A574;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .jump-to-section button:hover {
            background-color: #C08B5A;
            transform: translateY(-2px);
        }
        .hidden {
            display: none !important;
        }
        .icon {
            width: 50px;
            height: 50px;
            margin: 0 auto 15px auto;
            display: block;
        }
        @media (max-width: 768px) {
            .container {
                margin: 5px auto;
                border-radius: 12px;
            }
            .navbar-content {
                padding: 0 15px;
                flex-direction: column;
                gap: 10px;
            }
            .navbar-title {
                font-size: 1.2rem;
            }
            .home-button {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
            .back-button {
                position: relative;
                top: auto;
                left: auto;
                margin: 10px 0 0 0;
                font-size: 0.8rem;
                padding: 8px 12px;
            }
            .main-content {
                padding: 20px 15px;
            }
            .quiz-interface {
                padding: 20px 15px;
            }
            .menu-title {
                font-size: 1.4rem;
                margin-bottom: 20px;
            }
            .practice-areas, .subjects-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                margin-bottom: 30px;
            }
            .practice-area, .subject-card {
                padding: 25px 20px;
                min-height: 160px;
            }
            .practice-area h4, .subject-card h4 {
                font-size: 1.3rem;
                margin-bottom: 12px;
            }
            .practice-area p, .subject-card p {
                font-size: 1rem;
            }
            .icon {
                width: 40px;
                height: 40px;
                margin-bottom: 12px;
            }
            .question-area {
                padding: 15px;
            }
            .question-text {
                font-size: 1rem;
                line-height: 1.4;
            }
            .statement, .options .option {
                font-size: 0.95rem;
            }
            .quiz-navigation {
                flex-direction: column;
                gap: 15px;
                margin-top: 20px;
            }
            .quiz-navigation button {
                padding: 12px 20px;
                font-size: 0.95rem;
            }
            .jump-to-section {
                width: 100%;
                justify-content: center;
                flex-direction: column;
                gap: 8px;
            }
            .jump-to-section label {
                font-size: 0.9rem;
            }
            .jump-to-section input {
                width: 100px;
                padding: 10px;
            }
            .jump-to-section button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .navbar-content {
                padding: 0 10px;
            }
            .navbar-title {
                font-size: 1.1rem;
            }
            .main-content, .quiz-interface {
                padding: 15px 10px;
            }
            .menu-title {
                font-size: 1.2rem;
            }
            .practice-area, .subject-card {
                padding: 20px 15px;
                min-height: 140px;
            }
            .practice-area h4, .subject-card h4 {
                font-size: 1.2rem;
            }
            .practice-area p, .subject-card p {
                font-size: 0.95rem;
            }
            .icon {
                width: 35px;
                height: 35px;
            }
            .question-text {
                font-size: 0.95rem;
            }
            .statement, .options .option {
                font-size: 0.9rem;
            }
            .quiz-navigation button {
                padding: 10px 16px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="navbar-content">
            <span class="navbar-title">Singapore Part B Question Bank</span>
            <button class="home-button hidden" id="global-home-button" onclick="goHome()">🏠 Home</button>
        </div>
    </div>
    <div class="container">
        <!-- Main Menu -->
        <div id="main-menu" class="main-content">
            <h2 class="menu-title">Choose Your Topic</h2>
            <div class="practice-areas">
                <div class="practice-area" onclick="showCorporateSubjects()">
                    <img src="https://api.iconify.design/ph:buildings-bold.svg?color=%23D4A574" alt="Corporate Icon" class="icon">
                    <h4>1. Corporate & Commercial</h4>
                    <p>Banking, Governance, Insolvency, Admiralty, IP, M&A, Competition, Tax</p>
                </div>
                <div class="practice-area" onclick="showEthicsSubjects()">
                    <img src="https://api.iconify.design/ph:handshake-bold.svg?color=%23D4A574" alt="Ethics Icon" class="icon">
                    <h4>2. Ethics & Professional Responsibility</h4>
                    <p>Professional conduct, duties to clients and court</p>
                </div>
                <div class="practice-area" onclick="showDisputeResolutionSubjects()">
                    <img src="https://api.iconify.design/ph:gavel-bold.svg?color=%23D4A574" alt="Dispute Icon" class="icon">
                    <h4>3. Dispute Resolution Practice</h4>
                    <p>Civil litigation, arbitration, mediation</p>
                </div>
                <div class="practice-area" onclick="showPrivateClientSubjects()">
                    <img src="https://api.iconify.design/ph:users-bold.svg?color=%23D4A574" alt="Private Client Icon" class="icon">
                    <h4>4. Private Client Practice</h4>
                    <p>Family law, wills, probate, trusts</p>
                </div>
                <div class="practice-area" onclick="showContemporarySubjects()">
                    <img src="https://api.iconify.design/ph:lightbulb-bold.svg?color=%23D4A574" alt="Contemporary Icon" class="icon">
                    <h4>5. Contemporary Legal Knowledge & Practice</h4>
                    <p>Emerging legal issues, technology law</p>
                </div>
            </div>
        </div>

        <!-- Corporate & Commercial Subjects Menu -->
        <div id="corporate-subjects" class="main-content hidden">
            <button class="back-button hidden" id="global-back-button" onclick="goBackToSubjects()">&#8592; Back</button>
            <h2 class="menu-title">Corporate & Commercial Topics</h2>
            <div class="subjects-grid">
                <div class="subject-card" onclick="startQuiz('banking')">
                    <h4>A1. Banking & Fundraising</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('governance')">
                    <h4>A2. Corporate Governance</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('insolvency')">
                    <h4>A3. Insolvency & Corporate Restructuring</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('admiralty')">
                    <h4>A4. Admiralty</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('ip')">
                    <h4>B1. Intellectual Property</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('ma')">
                    <h4>B2. Mergers & Acquisitions</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('competition')">
                    <h4>B3. Competition Law</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('tax')">
                    <h4>B4. Tax</h4>
                    <p>100 Questions</p>
                </div>
            </div>
        </div>

        <!-- Ethics & Professional Responsibility Subjects Menu -->
        <div id="ethics-subjects" class="main-content hidden">
            <button class="back-button hidden" id="global-back-button" onclick="goBackToSubjects()">&#8592; Back</button>
            <h2 class="menu-title">Ethics & Professional Responsibility Topics</h2>
            <div class="subjects-grid">
                <div class="subject-card" onclick="alert('Questions for Relationship with Client are coming soon!')">
                    <h4>A1. Relationship with Client</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="window.open('ethics-week2.html', '_blank')">
                    <h4>A2. Practitioner's Role in Administration of Justice</h4>
                    <p>Comprehensive Notes Available</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Staff, Titles, Fees are coming soon!')">
                    <h4>A3. Staff, Titles, Fees</h4>
                    <p>Coming Soon</p>
                </div>
            </div>
        </div>

        <!-- Dispute Resolution Practice Subjects Menu -->
        <div id="dispute-resolution-subjects" class="main-content hidden">
            <button class="back-button hidden" id="global-back-button" onclick="goBackToSubjects()">&#8592; Back</button>
            <h2 class="menu-title">Dispute Resolution Practice Topics</h2>
            <div class="subjects-grid">
                <div class="subject-card" onclick="alert('Questions for Civil Litigation are coming soon!')">
                    <h4>A1. Civil Litigation</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Written Advocacy are coming soon!')">
                    <h4>A2. Written Advocacy</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="startQuiz('arbitration')">
                    <h4>B1. Arbitration</h4>
                    <p>100 Questions</p>
                </div>
                <div class="subject-card" onclick="startQuiz('mediation')">
                    <h4>B2. Mediation Advocacy</h4>
                    <p>100 Questions</p>
                </div>
            </div>
        </div>

        <!-- Private Client Practice Subjects Menu -->
        <div id="private-client-subjects" class="main-content hidden">
            <button class="back-button hidden" id="global-back-button" onclick="goBackToSubjects()">&#8592; Back</button>
            <h2 class="menu-title">Private Client Practice Topics</h2>
            <div class="subjects-grid">
                <div class="subject-card" onclick="alert('Questions for Criminal Litigation Practice are coming soon!')">
                    <h4>A1. Criminal Litigation Practice</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Family Law are coming soon!')">
                    <h4>A2. Family Law</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="startQuiz('muslim-family-law')">
                    <h4>B1. Muslim Family & Succession Law</h4>
                    <p>50 Questions</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Probate and Succession Planning are coming soon!')">
                    <h4>B2. Probate and Succession Planning</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Real Estate Practice are coming soon!')">
                    <h4>B3. Real Estate Practice</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Employment Law are coming soon!')">
                    <h4>B4. Employment Law</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Personal Injury and Property Damage are coming soon!')">
                    <h4>B5. Personal Injury and Property Damage</h4>
                    <p>Coming Soon</p>
                </div>
            </div>
        </div>

        <!-- Contemporary Legal Knowledge & Practice Subjects Menu -->
        <div id="contemporary-subjects" class="main-content hidden">
            <button class="back-button hidden" id="global-back-button" onclick="goBackToSubjects()">&#8592; Back</button>
            <h2 class="menu-title">Contemporary Legal Knowledge & Practice Topics</h2>
            <div class="subjects-grid">
                <div class="subject-card" onclick="alert('Questions for Data Protection and Cyber Regulations are coming soon!')">
                    <h4>A1. Data Protection and Cyber Regulations</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Laws and Technology are coming soon!')">
                    <h4>A2. Laws and Technology</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Comparative Laws are coming soon!')">
                    <h4>A3. Comparative Laws</h4>
                    <p>Coming Soon</p>
                </div>
                <div class="subject-card" onclick="alert('Questions for Conflict of Laws are coming soon!')">
                    <h4>A4. Conflict of Laws</h4>
                    <p>Coming Soon</p>
                </div>
            </div>
        </div>

        <!-- Quiz Interface -->
        <div id="quiz-interface" class="main-content hidden">
            <div class="quiz-header">
                <h2 id="quiz-title" class="quiz-title"></h2>
                <div class="progress-info">
                    Question <span id="current-question">1</span> / <span id="total-questions">100</span>
                </div>
            </div>
            <div class="question-area">
                <div>
                    <div class="question-text" id="question-text"></div>
                    <div class="statements" id="statements-container"></div>
                    <div class="options" id="options-container"></div>
                </div>
                <div class="quiz-navigation">
                    <button id="submit-btn" onclick="submitAnswer()">Submit Answer</button>
                    <div class="navigation-controls">
                        <button id="prev-btn" onclick="prevQuestion()" class="hidden">&#8592; Previous</button>
                        <button id="next-btn" onclick="nextQuestion()" class="hidden">Next &#8594;</button>
                    </div>
                    <div class="jump-to-section">
                        <label for="jump-input">Jump to Question:</label>
                        <input type="number" id="jump-input" min="1" placeholder="Q#">
                        <button onclick="jumpToQuestion()">Go</button>
                    </div>
                </div>
            </div>
            <div id="feedback-container" class="explanation hidden"></div>
        </div>
    </div>

    <script>
        // Global variables
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let selectedAnswer = null;
        let currentSubject = '';
        let questionCounts = {};

        // Subject configuration
        const subjects = {
            banking: { name: 'Banking & Finance', file: 'questions-banking.json' },
            governance: { name: 'Corporate Governance', file: 'questions-governance.json' },
            insolvency: { name: 'Insolvency', file: 'questions-insolvency.json' },
            admiralty: { name: 'Admiralty', file: 'questions-admiralty.json' },
            ip: { name: 'Intellectual Property', file: 'questions-ip.json' },
            tax: { name: 'Taxation', file: 'questions-tax.json' },
            competition: { name: 'Competition Law', file: 'questions-competition.json' },
            ma: { name: 'Mergers & Acquisitions', file: 'questions-ma.json' },
            arbitration: { name: 'Arbitration', file: 'questions-arbitration.json' },
            'muslim-family-law': { name: 'Muslim Family & Succession Law', file: 'questions-muslim-family-law-module1.json' }
        };

        // Load question counts on page load
        async function loadQuestionCounts() {
            for (const [key, subject] of Object.entries(subjects)) {
                try {
                    const response = await fetch(subject.file);
                    if (response.ok) {
                        const questions = await response.json();
                        questionCounts[key] = questions.length;
                    } else {
                        questionCounts[key] = 0;
                    }
                } catch (error) {
                    console.error(`Error loading ${subject.file}:`, error);
                    questionCounts[key] = 0;
                }
            }
        }

        // Start quiz for selected subject
        async function startQuiz(topic) {
            currentSubject = topic;
            const subject = subjects[topic];
            
            try {
                // Hide all menus
                document.getElementById('main-menu').classList.add('hidden');
                document.getElementById('corporate-subjects').classList.add('hidden');
                document.getElementById('ethics-subjects').classList.add('hidden');
                document.getElementById('dispute-resolution-subjects').classList.add('hidden');
                document.getElementById('private-client-subjects').classList.add('hidden');
                document.getElementById('contemporary-subjects').classList.add('hidden');
                
                // Show quiz interface
                document.getElementById('quiz-interface').classList.remove('hidden');
                document.getElementById('global-home-button').classList.remove('hidden');
                
                // Show loading state
                document.getElementById('quiz-title').textContent = subject.name;
                document.getElementById('question-text').textContent = 'Loading questions...';
                
                // Load questions
                const response = await fetch(subject.file);
                if (!response.ok) {
                    throw new Error(`Failed to load ${subject.file}`);
                }
                
                const data = await response.json();
                
                // Handle different JSON structures
                if (Array.isArray(data)) {
                    // Direct array format (banking, etc.)
                    currentQuestions = data;
                } else if (data.questions && Array.isArray(data.questions)) {
                    // Wrapped format with questions array (muslim family law)
                    currentQuestions = data.questions;
                } else {
                    throw new Error('Invalid question format');
                }
                
                currentQuestionIndex = 0;
                selectedAnswer = null;
                
                // Update UI
                document.getElementById('total-questions').textContent = currentQuestions.length;
                updateProgress();
                displayQuestion();
                
            } catch (error) {
                console.error('Error loading questions:', error);
                document.getElementById('question-text').textContent = 'Error loading questions. Please try again.';
            }
        }

        // Display current question
        function displayQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            selectedAnswer = null;

            // Update question number and progress
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('question-number').textContent = `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
            updateProgress();

            // Display question text
            document.getElementById('question-text').textContent = question.question;

            // Display statements
            const statementsContainer = document.getElementById('statements-container');
            if (question.statements && question.statements.length > 0) {
                statementsContainer.innerHTML = question.statements.map(statement => 
                    `<div class="statement">${statement}</div>`
                ).join('');
            } else {
                statementsContainer.innerHTML = '';
            }

            // Display options
            const optionsContainer = document.getElementById('options-container');
            let optionsArray;
            
            // Handle both array and object formats for options
            if (Array.isArray(question.options)) {
                optionsArray = question.options;
            } else if (typeof question.options === 'object') {
                // Convert object to array (A, B, C, D)
                optionsArray = Object.keys(question.options)
                    .sort() // Ensure A, B, C, D order
                    .map(key => `${key}. ${question.options[key]}`);
            }
            
            optionsContainer.innerHTML = optionsArray.map((option, index) => 
                `<div class="option" onclick="selectOption(${index})" data-option="${index}">${option}</div>`
            ).join('');

            // Update navigation buttons
            document.getElementById('prev-btn').classList.toggle('hidden', currentQuestionIndex === 0);
            document.getElementById('next-btn').classList.toggle('hidden', currentQuestionIndex === currentQuestions.length - 1);
            document.getElementById('submit-btn').style.display = 'block';

            // Hide feedback
            document.getElementById('feedback-container').classList.add('hidden');
        }

        // Select an option
        function selectOption(index) {
            // Remove previous selection
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });

            // Add selection to clicked option
            document.querySelector(`[data-option="${index}"]`).classList.add('selected');
            selectedAnswer = index;
        }

        // Submit answer
        function submitAnswer() {
            if (selectedAnswer === null) {
                alert('Please select an answer before submitting.');
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            const correctAnswer = question.correct_answer;
            
            // Handle both array and object formats for options
            let optionsArray, selectedOption, correctOption, isCorrect;
            
            if (Array.isArray(question.options)) {
                optionsArray = question.options;
                selectedOption = optionsArray[selectedAnswer];
                correctOption = optionsArray.find(option => option.startsWith(correctAnswer + '.'));
                isCorrect = selectedAnswer === optionsArray.findIndex(option => option.startsWith(correctAnswer + '.'));
            } else if (typeof question.options === 'object') {
                // Convert object to array for processing
                const sortedKeys = Object.keys(question.options).sort();
                optionsArray = sortedKeys.map(key => `${key}. ${question.options[key]}`);
                selectedOption = optionsArray[selectedAnswer];
                correctOption = optionsArray.find(option => option.startsWith(correctAnswer + '.'));
                isCorrect = selectedAnswer === optionsArray.findIndex(option => option.startsWith(correctAnswer + '.'));
            }

            // Show feedback
            const feedbackContainer = document.getElementById('feedback-container');
            
            // Handle both string and object explanation formats
            let explanationText = '';
            let referenceText = '';
            
            if (typeof question.explanation === 'string') {
                explanationText = question.explanation;
                referenceText = question.reference || '';
            } else if (typeof question.explanation === 'object') {
                explanationText = question.explanation.correct || '';
                referenceText = question.explanation.reference || '';
            }
            
            feedbackContainer.innerHTML = `
                <h3>${isCorrect ? '✅ Correct!' : '❌ Incorrect'}</h3>
                <div class="explanation-content">
                    <p><strong>Your Answer:</strong> ${selectedOption}</p>
                    <p><strong>Correct Answer:</strong> ${correctOption}</p>
                    <p><strong>Explanation:</strong> ${explanationText}</p>
                    ${question.detailed_explanation ? `<p><strong>Detailed Explanation:</strong></p><p>${question.detailed_explanation.replace(/\n/g, '<br>')}</p>` : ''}
                    ${referenceText ? `<p><strong>Reference:</strong> ${referenceText}</p>` : ''}
                </div>
            `;
            
            feedbackContainer.classList.remove('hidden');
            feedbackContainer.classList.add('show');

            // Hide submit button
            document.getElementById('submit-btn').style.display = 'none';
        }

        // Navigate to previous question
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        // Navigate to next question
        function nextQuestion() {
            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            }
        }

        // Jump to specific question
        function jumpToQuestion() {
            const jumpInput = document.getElementById('jump-input');
            const questionNum = parseInt(jumpInput.value);
            
            if (questionNum >= 1 && questionNum <= currentQuestions.length) {
                currentQuestionIndex = questionNum - 1;
                displayQuestion();
                jumpInput.value = '';
            } else {
                alert(`Please enter a number between 1 and ${currentQuestions.length}`);
            }
        }

        // Update progress bar
        function updateProgress() {
            const progressBar = document.getElementById('progress-fill');
            if (progressBar) {
                const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
                progressBar.style.width = `${progress}%`;
            }
        }

        // Navigation functions for showing different subject menus
        function showCorporateSubjects() {
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('corporate-subjects').classList.remove('hidden');
            document.getElementById('global-home-button').classList.remove('hidden');
        }

        function showEthicsSubjects() {
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('ethics-subjects').classList.remove('hidden');
            document.getElementById('global-home-button').classList.remove('hidden');
        }

        function showDisputeResolutionSubjects() {
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('dispute-resolution-subjects').classList.remove('hidden');
            document.getElementById('global-home-button').classList.remove('hidden');
        }

        function showPrivateClientSubjects() {
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('private-client-subjects').classList.remove('hidden');
            document.getElementById('global-home-button').classList.remove('hidden');
        }

        function showContemporarySubjects() {
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('contemporary-subjects').classList.remove('hidden');
            document.getElementById('global-home-button').classList.remove('hidden');
        }

        function goHome() {
            // Hide all subject menus and quiz interface
            document.getElementById('corporate-subjects').classList.add('hidden');
            document.getElementById('ethics-subjects').classList.add('hidden');
            document.getElementById('dispute-resolution-subjects').classList.add('hidden');
            document.getElementById('private-client-subjects').classList.add('hidden');
            document.getElementById('contemporary-subjects').classList.add('hidden');
            document.getElementById('quiz-interface').classList.add('hidden');
            
            // Show main menu
            document.getElementById('main-menu').classList.remove('hidden');
            document.getElementById('global-home-button').classList.add('hidden');
        }

        function goBackToSubjects() {
            // This function is called from back buttons in subject menus
            goHome();
        }


        // Initialize on page load
        document.addEventListener('DOMContentLoaded', loadQuestionCounts);
    </script>
</body>
</html>